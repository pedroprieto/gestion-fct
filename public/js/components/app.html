<link rel='ractive' href='./collection.html' name='c1'>

<c1 collection="{{collection}}"></c1>


<script>

// Only load if we are in browser
if (typeof window !== 'undefined') {
  require('fetch');
}

component.exports = {
  oninit: function() {
    this.on( '*.followLink', function ( event ) {
      var url = event.context.href;
      
      ins = this;

      // Ajax call and update collection
      fetch(url, {
	credentials: 'same-origin',
	headers: {
	  'Accept': 'application/vnd.collection+json'
	}
      })
	.then(function(response) {
	  return response.text()
	}).then(function(text) {
	  ins.set({'collection': JSON.parse(text).collection});
	}).catch(function(ex) {
	  console.log('parsing failed', ex)
	});

      return false;

    });
    
  },
  computed: {
    //TODO
    col_processed: function () {
      var c = this.get('collection');
      return 'ay2' + c.href;
    }
  }
  
};

</script>
